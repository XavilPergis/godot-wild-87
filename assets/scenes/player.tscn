[gd_scene load_steps=17 format=3 uid="uid://c6dxdh2j650h2"]

[ext_resource type="Script" uid="uid://j7ivnt71yxbe" path="res://assets/scripts/basic_gameplay/basic_player.gd" id="1_s027a"]
[ext_resource type="Script" uid="uid://gi1wna232m0o" path="res://assets/scripts/components/HealthComponent.gd" id="2_14505"]
[ext_resource type="Texture2D" uid="uid://15684ighxknx" path="res://assets/sprites/player/player_face_N.png" id="3_8sknh"]
[ext_resource type="Texture2D" uid="uid://rb144dq1sf3u" path="res://assets/sprites/player/player_crawl.png" id="3_hrrj1"]
[ext_resource type="Texture2D" uid="uid://djcguli2tec65" path="res://assets/sprites/player/player_step_N.png" id="4_0gfpk"]
[ext_resource type="Script" uid="uid://ck0vjtfvp7vih" path="res://assets/scripts/billboard_sprite_rotator.gd" id="4_8sknh"]
[ext_resource type="Texture2D" uid="uid://def3hl6qn3xmi" path="res://assets/sprites/player/player_crawl_reverse.png" id="4_c6vv5"]
[ext_resource type="Texture2D" uid="uid://dv06rai65ospt" path="res://assets/sprites/player/player_face_S.png" id="5_tc801"]
[ext_resource type="Texture2D" uid="uid://dsin2ppoprhmc" path="res://assets/sprites/player/player_step_S.png" id="6_60g6h"]
[ext_resource type="Texture2D" uid="uid://bi36u1ja7rqgi" path="res://assets/sprites/player/player_face_W.png" id="7_hrrj1"]
[ext_resource type="Texture2D" uid="uid://dbke2my73rj3l" path="res://assets/sprites/player/player_step_W.png" id="8_c6vv5"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_tc801"]
radius = 0.4
height = 1.7

[sub_resource type="CylinderShape3D" id="CylinderShape3D_60g6h"]
height = 0.25
radius = 0.4

[sub_resource type="CylinderShape3D" id="CylinderShape3D_hrrj1"]
height = 0.25
radius = 0.25

[sub_resource type="SpriteFrames" id="SpriteFrames_0e2pd"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_hrrj1")
}, {
"duration": 1.0,
"texture": ExtResource("4_c6vv5")
}],
"loop": true,
"name": &"crawl",
"speed": 2.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_8sknh")
}],
"loop": true,
"name": &"idle_N",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_tc801")
}],
"loop": true,
"name": &"idle_S",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_hrrj1")
}],
"loop": true,
"name": &"idle_W",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_8sknh")
}, {
"duration": 1.0,
"texture": ExtResource("4_0gfpk")
}],
"loop": true,
"name": &"walk_N",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("5_tc801")
}, {
"duration": 1.0,
"texture": ExtResource("6_60g6h")
}],
"loop": true,
"name": &"walk_S",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_hrrj1")
}, {
"duration": 1.0,
"texture": ExtResource("8_c6vv5")
}],
"loop": true,
"name": &"walk_W",
"speed": 5.0
}]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_tc801"]
radius = 1.0

[node name="Player" type="CharacterBody3D"]
collision_layer = 5
script = ExtResource("1_s027a")
speed = 6.0

[node name="HealthComponent" type="Node" parent="."]
script = ExtResource("2_14505")
metadata/_custom_type_script = "uid://gi1wna232m0o"

[node name="StandingShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.85, 0)
shape = SubResource("CapsuleShape3D_tc801")

[node name="CrawlingShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.125, 0)
shape = SubResource("CylinderShape3D_60g6h")
disabled = true

[node name="StandingAllowedCast" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
shape = SubResource("CylinderShape3D_hrrj1")
target_position = Vector3(0, 1.2, 0)
max_results = 1
debug_shape_custom_color = Color(0.083333254, 1, 0, 0.4509804)

[node name="BillboardSprite" type="AnimatedSprite3D" parent="."]
transform = Transform3D(-1, 0, 8.742278e-08, 0, 1, 0, -8.742278e-08, 0, -1, 0, 0.8279698, 0)
pixel_size = 0.0009
billboard = 1
texture_filter = 2
sprite_frames = SubResource("SpriteFrames_0e2pd")
animation = &"crawl"
frame_progress = 0.56147647

[node name="BillboardSpriteRotator" type="Node" parent="BillboardSprite" node_paths=PackedStringArray("sprite")]
script = ExtResource("4_8sknh")
sprite = NodePath("..")
initial_animation = "walk"
metadata/_custom_type_script = "uid://ck0vjtfvp7vih"

[node name="CrawlSprite" type="AnimatedSprite3D" parent="."]
transform = Transform3D(-1, 0, 8.742278e-08, -8.742278e-08, -4.371139e-08, -1, 3.821371e-15, -1, 4.371139e-08, 0, 0.2510199, 0)
visible = false
pixel_size = 0.0009
texture_filter = 2
sprite_frames = SubResource("SpriteFrames_0e2pd")
animation = &"crawl"
frame_progress = 0.56147647

[node name="FirstPersonAnchor" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)

[node name="LookAroundWallAnchor" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)

[node name="Eyes" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)

[node name="RightVisibility" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1.5, 0)
target_position = Vector3(0, 0, -1)

[node name="LeftVisibility" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1, 1.5, 0)
target_position = Vector3(0, 0, -1)

[node name="InteractionArea" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 8

[node name="InteractionShape" type="CollisionShape3D" parent="InteractionArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_tc801")

[connection signal="died" from="HealthComponent" to="." method="_on_health_component_died"]
[connection signal="took_damage" from="HealthComponent" to="." method="_on_health_component_took_damage"]
